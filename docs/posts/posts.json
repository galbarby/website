[
  {
    "path": "posts/2022-10-08-powerlifting-analysis-using-r/",
    "title": "powerlifting analysis using R",
    "description": "Analyzing powerlifting competitions from ipf federation.",
    "author": [
      {
        "name": "Gal Barby",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2022-10-08",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nStatistical Analyses\r\nBench Press - Squat Ratio Difference Between Male and Female\r\nBench Press - Deadlift Ratio\r\nGood Lift and No Lift Analysis\r\n\r\nNon-statistical Analyses\r\nWilks and Records Analysis\r\nDifferences Between Countries\r\nCompeted the Most Amount of Times\r\n\r\n\r\nIn this project, I will analyze powerlifting competitions from the famous federation called the IPF.\r\nThe first group is a series of statistical analyses that show some interesting things that may help several competitors.\r\nThe second group is analyses that show rare things in IPF and powerlifting in general.\r\nPowerlifting is a strength sport in which the goal of each competitor in the basic competition is to lift the heaviest amount of weight among three lifts.\r\nIn every lift, the competitor receives three attempts, where his/her next attempt must be equal or heavier to that of the last one, “good lift” is considered a success, and “no lift” is considered a failure.\r\nEvery lift has three referees that raise a white flag or red flag.\r\nFor “good lift” the competitor must receive at least two white flags.\r\nIn each lift there can be some reasons for red flags, the obvious one is if the competitor did not complete the lift.\r\nThe lifter’s best valid attempt (heaviest “good lift”) on each lift counts toward the competition “total”.\r\nAfter three attempts, the competitors continue to the next lift in the following order: squat, bench press, and deadlift. The winner in each category (the category is sectioned by gender, age, and weight) is the one with the heaviest “total”.\r\nTo start, let’s load the following libraries:\r\n\r\n\r\nShow code\r\n\r\nlibrary(kableExtra)\r\nlibrary(flextable)\r\nlibrary(pander)\r\nlibrary(gganimate)\r\nlibrary(gdata)\r\nlibrary(readxl)\r\nlibrary(ggplot2)\r\nlibrary(tidyverse)\r\n\r\n\r\nI took the database from https://openpowerlifting.gitlab.io/opl-csv/bulk-csv.html\r\nThe IPF has some competitions per period so apparently, there are some small changes in parts of the analysis.\r\nEvery row in the database refers to one competitor, in the original database, there are more than a million rows.\r\nIn addition, the original data includes non-basic competitions, so at first, I did a data cleaning in separate code and saved the relevant data frame as a different file.\r\nThe next code chunk is customized with eval=FALSE.\r\nThis means that this code chunk doesn’t run because it has been used before.\r\nThe clean data frame that I created includes only the following competitors:\r\ncompeted in Raw and SBD events.\r\ntheir gender and weight class were identified.\r\nall the attempts were identified with at least one “good lift” in every exercise.\r\nI cleaned the data more than required just in case (even with the clean data, there is enough information).\r\nThe last thing I did was to save only important information about every competitor (row).\r\nThe meet name, for example, is irrelevant to this project.\r\nNext, I split the clean data frame into two different data frames.\r\nThe first one is the clean data that I created with the next code.\r\nThe second data frame is data that includes one competition per competitor.\r\nThis is because some competitors compete more than once and that may bias the results.\r\n\r\n\r\nShow code\r\n\r\ndat <- read.csv(\"open ipf.csv\")\r\nipf_data <- dat %>%\r\n  filter(Equipment==\"Raw\",Event==\"SBD\",Sex!=\"Mx\",WeightClassKg!=\"+\",\r\n         !is.na(Squat1Kg & Bench1Kg & Deadlift1Kg &\r\n                  Squat2Kg & Bench2Kg & Deadlift2Kg &\r\n                  Squat3Kg & Bench3Kg & Deadlift3Kg),\r\n         Best3SquatKg>0,Best3BenchKg>0,Best3DeadliftKg>0) %>%\r\n  select(-MeetName,-MeetTown,-MeetState,-MeetCountry,-Federation,-Equipment,\r\n         -Glossbrenner,-Dots)\r\nipf_data %>% writexl::write_xlsx(path = \"the final ipf cleaned data2.xlsx\")\r\n\r\n\r\nMore about the data cleaning\r\nin first i ..\r\nStatistical Analyses\r\nBench Press - Squat Ratio Difference Between Male and Female\r\nThe first analysis checks a familiar phenomenon:\r\nwhen males, in general, have stronger bodies than females,\r\nThe difference is not very significant in terms of the lower body, in comparison to the upper body, where there is a major dissimilarity.\r\nThe squat is an exercise that ably demonstrates lower body strength and the bench press is an exercise that effectively demonstrates upper body strength.\r\nSo, in the following analysis, I checked the ratio between the bench press of the males versus females and I compared it to the ratio of the males’ and females’ squats.\r\nI executed the next mathematical transition to make my hypothesis and conclusions more understandable:(SQ - squat)(BP - bench press)\r\n\\[\r\n\\hspace{2mm}H_O: \\dfrac{maleBP}{femaleBP}<=\\dfrac{maleSQ}{femaleSQ}\\\\\r\n\\hspace{1mm}H1: \\dfrac{maleBP}{femaleBP}\\hspace{0.5mm}>\\hspace{1mm}\\dfrac{maleSQ}{femaleSQ}\\\\\r\n\\hspace{1mm}H_O: \\dfrac{maleBP}{maleSQ}\\hspace{1mm}<=\\hspace{1mm}\\dfrac{femaleBP}{femaleSQ}\\\\\r\nH1:\\hspace{1mm}\\dfrac{maleBP}{maleSQ}\\hspace{2mm}>\\hspace{2mm}\\dfrac{femaleBP}{femaleSQ}\\\\\r\n\\]\r\n(I multiplied by \\(\\dfrac{femaleBP}{maleSQ}\\) (positive digit)).\r\nThe squat and the bench press that I used are the best attempts of the competitor.\r\nDue to the data cleaning, all the competitors on the new data have at least one good attempt.\r\nIn addition, the data frame that I used for this analysis is called, “dat”, which includes one competition per competitor.\r\n\r\n\r\nShow code\r\n\r\nrepeated_dat <- read_excel(\"the final ipf cleaned data2.xlsx\",guess_max = 20000)\r\ndat <- repeated_dat %>% distinct(Name, .keep_all = TRUE)\r\ndat <- dat %>%  mutate(squat_bench_ratio=Best3BenchKg/Best3SquatKg)\r\nM_sq_bp_ratio <- dat %>% filter(Sex==\"M\") %>% pull(squat_bench_ratio)\r\nF_sq_bp_ratio <- dat %>% filter(Sex==\"F\") %>% pull(squat_bench_ratio)\r\nsq_bp_test <- t.test(M_sq_bp_ratio,F_sq_bp_ratio)\r\npander(sq_bp_test,split.cells = 2)\r\n\r\nWelch Two Sample t-test: M_sq_bp_ratio and F_sq_bp_ratio\r\nTest\r\nstatistic\r\ndf\r\nP\r\nvalue\r\nAlternative\r\nhypothesis\r\nmean\r\nof\r\nx\r\nmean\r\nof\r\ny\r\n143.9\r\n71497\r\n0\r\n\r\n\r\n*\r\ntwo.sided\r\n0.68\r\n0.5717\r\n\r\nShow code\r\n\r\nggplot(dat) + \r\n  geom_density(aes(x=squat_bench_ratio, colour=Sex, fill=Sex), alpha=0.5) + \r\n  xlim(0,1.5) +\r\n  xlab(\"squat - bench press ratio\")\r\n\r\n\r\n\r\nThe essence of the result is as follows:The average weight of the males’ bench press is about 68% of the weight of their squat.The average weight of the Females’ bench press is about 57% of the weight of their squat.\r\nThe result is statistically highly significant and this justifies the alternative hypothesis.\r\nBench Press - Deadlift Ratio\r\nAs we saw, the ratio between two different lifts in one group can be unequal to the ratio of the same lifts in another type of group.\r\n\r\nElchonon Brody, one of the best powerlifting coaches in Israel (and thanks to him I held the Israeli record of bench press in my category) proposed the following hypothesis:\r\n\r\nThere is a difference between the ratio of two lifts in different body-weight classes.\r\n\r\n\r\nThe deadlift is a pull exercise, and the bench press is a push exercise.\r\nTherefore, there is an importance in the ratio between them for reasons of balance and body health.\r\nConsequently, I decided to check the ratio between the deadlift and bench press using the following hypothesis of Elchonon:(DL - dead lift)(HW - Heavy body weight class)(LW - Low body weight class)\r\n\\[\r\nH_O: \\dfrac{HWBP}{HWDL}<=\\dfrac{LWBP}{LWDL}\\\\\r\nH1: \\dfrac{HWBP}{HWDL}\\hspace{2.2mm}>\\hspace{2.2mm}\\dfrac{LWBP}{LWDL}\\\\\r\n\\]\r\nDifference between various competitors:\r\nElchonon believes that the ratio between bench press and deadlift is higher with heavy-weight competitors in comparison to light-weight competitors.\r\nSo, in the following analysis, I studied the hypothesis with multiple comparisons between varying weight classes.\r\nBecause we know that the ratio between different lifts can be influenced by gender, I performed the analysis only on males.\r\nIn addition, I analyzed which class has the most competitors, and then I picked the five that had the most significant difference between their weight.\r\n\r\n\r\nShow code\r\n\r\ndat <- dat %>% mutate(deadlift_bench_ratio=Best3BenchKg/Best3DeadliftKg)\r\npander(dat %>% filter(Sex==\"M\") %>% count(WeightClassKg) %>% arrange(desc(n)) %>% slice(1:10))\r\n\r\nWeightClassKg\r\nn\r\n93\r\n14856\r\n83\r\n14720\r\n105\r\n10485\r\n74\r\n10038\r\n120\r\n5424\r\n66\r\n4614\r\n120+\r\n3023\r\n59\r\n1960\r\n53\r\n466\r\n100\r\n340\r\n\r\nShow code\r\n\r\ncategories <- c(\"53\",\"59\",\"66\",\"93\",\"120+\")\r\nmultiple_comparisons_df <- dat %>% filter(WeightClassKg %in% categories,Sex==\"M\")\r\nmultiple_comparisons_df$WeightClassKg <- \r\n  reorder.factor(multiple_comparisons_df$WeightClassKg, new.order=categories)\r\nggplot(multiple_comparisons_df) + \r\n  geom_density(aes(x=deadlift_bench_ratio, colour=WeightClassKg, fill=WeightClassKg),\r\n               alpha=0.5) + xlim(0,1.5) + xlab(\"deadlift - bench press ratio\")\r\n\r\n\r\nShow code\r\n\r\npander(multiple_comparisons_df %>% group_by(WeightClassKg) %>% \r\n        summarise(ratio=mean(deadlift_bench_ratio)))\r\n\r\nWeightClassKg\r\nratio\r\n53\r\n0.5078\r\n59\r\n0.5349\r\n66\r\n0.548\r\n93\r\n0.5764\r\n120+\r\n0.6245\r\n\r\nShow code\r\n\r\ndl_bp_ratio <- multiple_comparisons_df$deadlift_bench_ratio\r\nwc_kg <- multiple_comparisons_df$WeightClassKg\r\ndl_bp_test <- pairwise.t.test(dl_bp_ratio,wc_kg,p.adjust.method=\"bonferroni\")\r\npander(dl_bp_test,split.cells = 2)\r\n\r\nmethod: t tests with pooled SD\r\ndata.name: dl_bp_ratio and wc_kg\r\np.value:\r\n \r\n53\r\n59\r\n66\r\n93\r\n59\r\n1.518e-07\r\nNA\r\nNA\r\nNA\r\n66\r\n5.003e-18\r\n1.466e-06\r\nNA\r\nNA\r\n93\r\n1.895e-54\r\n4.924e-76\r\n2.681e-72\r\nNA\r\n120+\r\n2.453e-138\r\n2.004e-237\r\n9.274e-265\r\n4.641e-146\r\n\r\np.adjust.method: bonferroni\r\n\r\nAs you can see, the bench press weight of the lightest weight class is 50.7% of the weight of their deadlift.You can see that when the weight class increases, the percentage goes up too.In addition, every pairwise comparison is statistically highly significant.\r\ndifference between the same competitors:\r\nThe previous analysis is not enough to give suggestions, because each group has individual characteristics that can affect this result.\r\n(\\(BD_{ratio}\\) - bench press - deadlift ratio)\r\n\\[\r\nBD_{ratio}=weight_{class}+\\epsilon\r\n\\]\r\nEvery weight class has its random errors (\\(\\epsilon\\)) that may correlate with the ratio of bench press - deadlift and weight class too.\r\nHeight for example is one of them.\r\nThese correlations can affect the consistency of our estimator.\r\nThe solution that I came up with is to use the “repeated data” (the data frame which includes competitors who compete more than once).\r\nWith this data frame, I can include competitors that compete in more than one body-weight class and by that solve the consistency problem.\r\nThese competitors have several fixed characteristics that we can lose when we execute a paired ‘t test’.\r\nIn this method, we remove a part of the random errors that affected our estimation.\r\n\r\n\r\nShow code\r\n\r\nrepeated_dat_bp_dl <- repeated_dat %>% filter(!is.na(WeightClassKg),!is.na(BodyweightKg)) %>% \r\n  mutate(deadlift_bench_ratio=Best3BenchKg/Best3DeadliftKg)\r\nsplited_repeated <- repeated_dat_bp_dl %>% distinct(Name,WeightClassKg,.keep_all = T) %>% \r\n  group_by(Name) %>% filter(n()>1) %>%\r\n  summarize(Name,WeightClassKg,BodyweightKg,deadlift_bench_ratio,n=n()) %>% ungroup() %>% \r\n  arrange(n,Name,WeightClassKg) %>% group_split(n,.keep = T)\r\n\r\nmake_pairs <- function(data){\r\n  n <- data %>% pull(n) %>% unique()\r\n  pair_1 <- data[seq(1,nrow(data),by=n),]\r\n  pair_2 <- data[seq(n,nrow(data),by=n),]\r\n  return(bind_rows(pair_1,pair_2) %>% arrange(Name,BodyweightKg))\r\n}\r\n\r\npairs_list <- lapply(splited_repeated,make_pairs)\r\npairs_dat <- bind_rows(pairs_list)\r\nweights_vec <- pairs_dat %>% pull(deadlift_bench_ratio)\r\nheavier_weight <- weights_vec[seq(2,length(weights_vec),by=2)]\r\nlower_weight <- weights_vec[seq(1,length(weights_vec),by=2)]\r\npair_test <- t.test(x = heavier_weight,y=lower_weight,paired = T)\r\npander(pair_test,split.cells = 2)\r\n\r\nPaired t-test: heavier_weight and lower_weight\r\nTest\r\nstatistic\r\ndf\r\nP\r\nvalue\r\nAlternative\r\nhypothesis\r\nmean\r\ndifference\r\n27.07\r\n20059\r\n1.63e-158\r\n\r\n\r\n*\r\ntwo.sided\r\n0.01179\r\n\r\nNow, it is easier for me to suggest some things.\r\nFor example, for an individual who has shoulder pain that is caused by stronger push muscles than pull muscles, I will suggest considering this analysis.\r\nIn addition, I would recommend reducing some load on this competitor’s push exercise and to lose body weight.Despite my recommendation to lose weight, I must note weight loss reduces the ratio between deadlift and bench press only by 1.1%.\r\nGood Lift and No Lift Analysis\r\nThe last statistic analysis consists of two analyses.\r\nThe first one detects if there is the same quantity of “good lift” in each exercise.\r\nThe second analysis checks if there is a correlation between one lift fail/success and another lift fail/success.\r\nIn these two analyses, I used the third attempt of every lift.\r\nIn the second analysis, I analyzed the correlation between the squat and the bench press because there are the most diverse exercises (therefore, the correlation between them is less obvious than the other combination).\r\nQuantity of “good lift” in different lifts:\r\n\r\n\r\nShow code\r\n\r\n#prop test squat3 bench3 and deadlift3 no lift\r\ndat <- dat %>% mutate(G_squat3 = case_when(Squat3Kg>0 ~ 1,\r\n                                          TRUE ~ 0),\r\n                        G_bench3 = case_when(Bench3Kg>0 ~ 1,\r\n                                          TRUE ~ 0),\r\n                        G_deadlift3 = case_when(Deadlift3Kg>0 ~ 1,\r\n                                          TRUE ~ 0))\r\nG_sq <- dat %>% filter(G_squat3==1) %>% nrow()\r\nG_bp <- dat %>% filter(G_bench3==1) %>% nrow()\r\nG_dl <- dat %>% filter(G_deadlift3==1) %>% nrow()\r\npop <- dat %>% nrow()\r\nprecent <- round(c(G_sq/pop,G_bp/pop,G_dl/pop),2)\r\nprecent <- precent*100\r\nprecent <- as.character(precent)\r\nprecent <- paste(c(\"squat:\",\"bench press:\",\"dead lift:\"),precent)\r\nwriteLines(c(\"good lift percentage:\",precent))\r\n\r\ngood lift percentage:\r\nsquat: 67\r\nbench press: 46\r\ndead lift: 65\r\n\r\nShow code\r\n\r\nmy_test4 <- pairwise.prop.test(x = c(G_sq,G_bp,G_dl), n = rep(pop,3), p.adjust.method = \"bonferroni\")\r\npander(my_test4,split.cells = 2)\r\n\r\nmethod: Pairwise comparison of proportions\r\ndata.name: c(G_sq, G_bp, G_dl) out of rep(pop, 3)\r\np.value:\r\n \r\n1\r\n2\r\n2\r\n0\r\nNA\r\n3\r\n1.193e-16\r\n0\r\n\r\np.adjust.method: bonferroni\r\n\r\nThe first analysis found that on average, the percentage of the “good lift” on the third attempt is:squat - 67%, bench press - 46%, deadlift - 65%.\r\nWith the Bonferroni method, I found that the difference between every lift is statistically highly significant.\r\n(In part of the table, you can see a p-value that is equal to zero, that’s because it is too low).\r\nThe meaning of this result is that even the 2% difference between squat and deadlift is a very rare result if the amount of “good lift” is equal between squat and deadlift.One interesting thing I found that powerlifters can use from this analysis, is the low proportion of “good lift” in the bench press.On average, there is more “no lift” than “good lift” in the third attempt, so powerlifters should take into account this result and plan the bench press attempts accordingly.\r\nCorrelation between exercises’ success/fails:\r\n\r\n\r\nShow code\r\n\r\n#chisq test no lift squat and bench\r\nmy_test5 <- chisq.test(dat$G_squat3,dat$G_bench3,correct = F)\r\npander(my_test5,split.cells = 2)\r\n\r\nPearson’s Chi-squared test: dat$G_squat3 and dat$G_bench3\r\nTest\r\nstatistic\r\ndf\r\nP\r\nvalue\r\n832.2\r\n1\r\n5.368e-183\r\n\r\n\r\n*\r\n\r\nShow code\r\n\r\nobs11 <- dat %>% filter(G_bench3==1,G_squat3==1) %>% nrow()/pop\r\nobs10 <- dat %>% filter(G_bench3==1,G_squat3==0) %>% nrow()/pop\r\nobs01 <- dat %>% filter(G_bench3==0,G_squat3==1) %>% nrow()/pop\r\nobs00 <- dat %>% filter(G_bench3==0,G_squat3==0) %>% nrow()/pop\r\n\r\nexp11 <- (as.numeric(G_bp)*as.numeric(G_sq))/(pop^2)\r\nexp10 <- (G_bp*(dat %>% filter(G_squat3==0) %>% nrow))/(pop^2)\r\nexp01 <- \r\n  (as.numeric(dat %>% filter(G_bench3==0) %>% nrow)*G_sq)/(pop^2)\r\nexp00 <- \r\n  ((dat %>% filter(G_bench3==0) %>% nrow)*(dat %>% filter(G_squat3==0) %>% nrow))/(pop^2)\r\ndf <- data.frame(\r\n  group=c(\"11\",\"10\",\"01\",\"00\",\"11\",\"10\",\"01\",\"00\"),\r\n  value=c(obs11,obs10,obs01,obs00,exp11,exp10,exp01,exp00),\r\n  type=c(rep(\"observed\",4),rep(\"expected\",4))\r\n)\r\n\r\np <- ggplot(df, aes(x=\"\", y=value, fill=group)) +\r\n  geom_bar(stat=\"identity\", width=1, color=\"white\") + \r\n  geom_text(aes(label = round(value,4)),\r\n            position = position_stack(vjust = 0.5)) +\r\n  coord_polar(\"y\", start=0) + theme_void() + facet_wrap(~type)\r\np\r\n\r\n\r\n\r\nI will explain the second analysis via the pie chart:On the right side you can see the group splitting, the left number refers to bench press and the right number refers to squat.For example, ‘01’ (the color green) means “no lift” for bench press, and “good lift” for squat.\r\nThe left pie chart shows the expected values of each option (the result that was expected if there is no correlation between the lifts).\r\nThe right pie chart shows the real values that I received (the observed values).As you can see the ‘00’ and ‘11’ groups received a bigger part on the observed chart, while the ‘01’ and ‘10’ got a smaller part on the observed chart.So, the squat and the bench press get the same value 52.68% of the time (“good lift”+“no lift”).While on the expected option (the option that there is no correlation between them) they get the same value only 48.6% of the time.\r\nIn addition to the intuitive explanation, you can see the ‘chisq test’ before the pie chart, which detects if there is a statistically significant difference between the expected and observed values.\r\nOn the ‘chisq test’, I got a statistically significant result.\r\nNon-statistical Analyses\r\nWilks and Records Analysis\r\nIn the following analysis, you will notice some interesting facts about powerlifting competitions.\r\nFirst of all, I presented the distribution of the age class from the age class with the least competitors to the age class with the most competitors.\r\nThe first analysis shows the oldest record in IPF (the heaviest total that no one has passed throughout the years in a specific category).\r\nThe second analysis shows the oldest record in IPF, with more than 1,000 competitors who compete in the specific category.\r\nThe third analysis shows the oldest competitor that ever competed on the IPF.\r\nYou can see the impressive weight he lifted as well.\r\nThe fourth analysis shows the heaviest total that a competitor 80 years old or more lifted in a competition.\r\nThis might give you quite a lot of motivation.\r\n(When you see 80-999 age group the meaning is age group with no limit)\r\n\r\n\r\nShow code\r\n\r\n## records analysis\r\nrecords_dat <- repeated_dat %>% filter(!is.na(AgeClass),!is.na(WeightClassKg),\r\n                                       !is.na(TotalKg))\r\n#oldest record\r\noldest_record <- records_dat %>% add_count(Sex,AgeClass,WeightClassKg) %>% \r\n  group_by(Sex,AgeClass,WeightClassKg) %>% slice_max(TotalKg) %>% \r\n  select(Sex,AgeClass,WeightClassKg,Name,Date,TotalKg) %>% arrange(Date)\r\nflextable(oldest_record %>% ungroup() %>% slice(1))\r\n\r\nSexAgeClassWeightClassKgNameDateTotalKgM24-34110+Don Reinhoudt1973-11-091,034.18\r\n\r\nShow code\r\n\r\n#oldest record with more than 1000 competitors\r\noldest_record1000 <- records_dat %>% add_count(Sex,AgeClass,WeightClassKg) %>% \r\n  filter(n>1000) %>% \r\n  group_by(Sex,AgeClass,WeightClassKg) %>% slice_max(TotalKg) %>% \r\n  select(Sex,AgeClass,WeightClassKg,Name,Date,TotalKg) %>% arrange(Date)\r\nflextable(oldest_record1000 %>% ungroup() %>% slice(1))\r\n\r\nSexAgeClassWeightClassKgNameDateTotalKgM16-1766Yosuke Kiuchi2014-03-23620\r\n\r\nShow code\r\n\r\n#age distribution\r\nAge_count <- dat %>% filter(!is.na(AgeClass))\r\nAge_count <- Age_count %>% count(AgeClass)\r\nggplot(Age_count,aes(x=reorder(AgeClass,desc(n)),y=n)) + geom_bar(stat='identity') +\r\n  coord_flip() + xlab(\"Age class\") + ylab(\"count\")\r\n\r\n\r\nShow code\r\n\r\n# the oldest competitor\r\nflextable(records_dat %>% arrange(desc(Age)) %>% \r\n  select(Name,Age,BodyweightKg,Best3SquatKg,\r\n         Best3BenchKg,Best3DeadliftKg,TotalKg) %>% slice(1))\r\n\r\nNameAgeBodyweightKgBest3SquatKgBest3BenchKgBest3DeadliftKgTotalKgSvend Stensgaard92.578.26560125250\r\n\r\nShow code\r\n\r\n# the heaviest total in 80 or more age group\r\nflextable(records_dat %>% filter(Age>=80) %>% slice_max(TotalKg) %>% \r\n  select(Name,Age,BodyweightKg,Best3SquatKg,\r\n         Best3BenchKg,Best3DeadliftKg,TotalKg) %>% slice(1))\r\n\r\nNameAgeBodyweightKgBest3SquatKgBest3BenchKgBest3DeadliftKgTotalKgEmil Alin81.5112.7155110200465\r\n\r\nShow code\r\n\r\n######################################## check something\r\n\r\nkbl(records_dat %>% arrange(desc(Age)) %>%\r\n  select(Name,Age,BodyweightKg,Best3SquatKg,\r\n         Best3BenchKg,Best3DeadliftKg,TotalKg) %>% slice(1)) %>% kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\r\n\r\n\r\nName\r\n\r\n\r\nAge\r\n\r\n\r\nBodyweightKg\r\n\r\n\r\nBest3SquatKg\r\n\r\n\r\nBest3BenchKg\r\n\r\n\r\nBest3DeadliftKg\r\n\r\n\r\nTotalKg\r\n\r\n\r\nSvend Stensgaard\r\n\r\n\r\n92.5\r\n\r\n\r\n78.2\r\n\r\n\r\n65\r\n\r\n\r\n60\r\n\r\n\r\n125\r\n\r\n\r\n250\r\n\r\n\r\nDifferences Between Countries\r\nTo understand this analysis, you must learn an additional term in power lifters’ vocabulary, ‘Wilks’.\r\nThe ‘Wilks’ is a formula that is used to compare lifters in different body weight classes in order to find the strongest lifter while taking into account the lifter’s body weight.\r\nFirst of all, I presented the countries that have the most amount of lifters.\r\nThe first analysis takes the lifters that get the highest Wilks score, and checks from which countries they originated from.\r\nThe second analysis compares the average of the ten highest Wilks scores in the USA vs. Russia.\r\nThe third analysis shows the countries with the most and the least percentages of female competitors (when taking only into consideration countries with more than 200 competitors).\r\n\r\n\r\nShow code\r\n\r\npander(dat %>% filter(!is.na(Country)) %>% count(Country) %>% arrange(desc(n)) %>% head())\r\n\r\nCountry\r\nn\r\nUSA\r\n43384\r\nEngland\r\n6991\r\nCanada\r\n4054\r\nGermany\r\n1052\r\nAustralia\r\n967\r\nRussia\r\n947\r\n\r\nShow code\r\n\r\n# strongest competitors\r\nwriteLines(dat %>% arrange(desc(Wilks)) %>% slice(1:5) %>% pull(Country) %>% unique())\r\n\r\nUSA\r\nRussia\r\nPoland\r\n\r\nShow code\r\n\r\n#USA vs Russia\r\npander(dat %>% filter(Country==\"USA\") %>% arrange(desc(Wilks)) %>% slice(1:10) %>% \r\n  pull(Wilks) %>% mean())\r\n\r\n561.4\r\n\r\nShow code\r\n\r\npander(dat %>% filter(Country==\"Russia\") %>% arrange(desc(Wilks)) %>% slice(1:10) %>% \r\n  pull(Wilks) %>% mean())\r\n\r\n521.7\r\n\r\nShow code\r\n\r\n#most and least percentages of female competitors\r\ndat_fem <- dat %>% add_count(Country) %>% filter(n>200)\r\ndat_fem <- dat_fem %>% group_by(Country) %>% summarise(female_precentage=mean(Sex==\"F\"))\r\npander(dat_fem %>% slice_max(female_precentage))\r\n\r\nCountry\r\nfemale_precentage\r\nSweden\r\n0.4656\r\n\r\nShow code\r\n\r\npander(dat_fem %>% slice_min(female_precentage))\r\n\r\nCountry\r\nfemale_precentage\r\nBelgium\r\n0.1648\r\n\r\nAs you can see, the strongest competitors in the IPF are from the USA, Russia, and Poland.If the strength of the lifter is independent of his/her country, Poland is a surprising result because there are many countries with more competitors than Poland.Another surprising result is the percentage of females that compete in Sweden in comparison to Belgium.\r\nThis result is even more surprising when we look at the female percentage in Sweden and Belgium over the years:https://data.worldbank.org/indicator/SP.POP.TOTL.FE.ZS?locations=SE-BE\r\nBelgium’s female percentage was higher than Sweden’s female percentage from 1960 to 2021.\r\nHowever, Sweden has a higher score on ‘Gender Equality Index’ in every year that exists in the following link:https://eige.europa.eu/gender-equality-index/2021/compare-countries/index/bar\r\nThose who are interested in this difference can request from me more analyses on the females’ percentage in IPF.\r\nThese two factors I mentioned do not suffice. Another analysis can detect countries with a lower female percentage and a lower score on the ‘Gender Equality Index’ in comparison to Belgium. Nevertheless, Belgium is the country with the lowest female percentage in IPF.\r\nTherefore, additional factors influence the observed result.\r\nCompeted the Most Amount of Times\r\nIn this final analysis, I found the competitor that competed the most amount of times in the IPF (remember, this data includes only SBD and RAW events).\r\n\r\n\r\nShow code\r\n\r\npander(repeated_dat %>% count(Name) %>% arrange(desc(n)) %>% slice(1))\r\n\r\nName\r\nn\r\nCharlie Chester\r\n46\r\n\r\nShow code\r\n\r\nCharlie_progress <- repeated_dat %>% filter(Name==\"Charlie Chester\") %>% arrange(Date) %>% \r\n  select(Date,Best3SquatKg,Best3BenchKg,Best3DeadliftKg,TotalKg)\r\nCharlie_progress <- mutate(Charlie_progress, Date= as.Date(Date))\r\nCharlie_plot <- ggplot(Charlie_progress, aes(x=Date)) + \r\n  geom_line(aes(y = Best3SquatKg), color = \"blue\") + \r\n  geom_line(aes(y = Best3BenchKg), color=\"black\") +\r\n  geom_line(aes(y = Best3DeadliftKg), color=\"red\") +\r\n  transition_reveal(Date) +\r\n  labs(title = 'Competition : {frame_time}')\r\nanimate(\r\n  plot = Charlie_plot,\r\n  render = gifski_renderer())\r\n\r\n\r\n\r\nIn the graph, you can see Charlie’s bench press (in black), squat (in blue), and deadlift (in red).What you may find interesting is how the trends in the lifts are very similar.\r\nThe similar trends can match the ‘chisq test’ in this project, which ultimately found a correlation between squat and bench press success and failure.\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-10-08-powerlifting-analysis-using-r/powerlifting-analysis-using-r_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-11-04T16:47:27+02:00",
    "input_file": {}
  }
]
