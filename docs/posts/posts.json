[
  {
    "path": "posts/2022-10-08-powerlifting-analysis-using-r/",
    "title": "powerlifting analysis using R",
    "description": "Analyzing powerlifting competitions from ipf federation.",
    "author": [
      {
        "name": "Gal Barby",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2022-10-08",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nStatistical Analyses\r\nBench Press - Squat Ratio Difference Between Male and Female\r\nBench Press - Deadlift Ratio\r\nGood Lift and No Lift Analysis\r\n\r\nNon-statistical Analyses\r\nWilks and Records Analysis\r\nDifferences Between Countries\r\nCompeted the Most Amount of Times\r\n\r\n\r\nIn this project, I will analyze powerlifting competitions from the famous federation called the IPF.\r\nThe first group is a series of statistical analyses that show some interesting things that may help several competitors.\r\nThe second group is analyses that show rare things in IPF and powerlifting in general.\r\nPowerlifting is a strength sport in which the goal of each competitor in the basic competition is to lift the heaviest amount of weight among three lifts.\r\nIn every lift, the competitor receives three attempts, where his/her next attempt must be equal or heavier to that of the last one, “good lift” is considered a success, and “no lift” is considered a failure.\r\nEvery lift has three referees that raise a white flag or red flag.\r\nFor “good lift” the competitor must receive at least two white flags.\r\nIn each lift there can be some reasons for red flags, the obvious one is if the competitor did not complete the lift.\r\nThe lifter’s best valid attempt (heaviest “good lift”) on each lift counts toward the competition “total”.\r\nAfter three attempts, the competitors continue to the next lift in the following order: squat, bench press, and deadlift. The winner in each category (the category is sectioned by gender, age, and weight) is the one with the heaviest “total”.\r\nTo start, let’s load the following libraries:\r\n\r\n\r\nShow code\r\n\r\nlibrary(patchwork)\r\nlibrary(gt)\r\nlibrary(kableExtra)\r\nlibrary(ggthemes)\r\nlibrary(hrbrthemes)\r\nlibrary(CGPfunctions)\r\nlibrary(flextable)\r\nlibrary(pander)\r\nlibrary(gganimate)\r\nlibrary(gdata)\r\nlibrary(readxl)\r\nlibrary(ggplot2)\r\nlibrary(tidyverse)\r\n\r\n\r\nI took the database from https://openpowerlifting.gitlab.io/opl-csv/bulk-csv.html\r\nThe IPF has some competitions per period so apparently, there are some small changes in parts of the analysis.\r\nEvery row in the database refers to one competitor, in the original database, there are more than a million rows.\r\nIn addition, the original data includes non-basic competitions, so at first, I did a data cleaning in separate code and saved the relevant data frame as a different file.\r\nThe next code chunk is customized with eval=FALSE.\r\nThis means that this code chunk doesn’t run because it has been used before.\r\nThe clean data frame that I created includes only the following competitors:\r\ncompeted in Raw and SBD events.\r\ntheir gender and weight class were identified.\r\nall the attempts were identified with at least one “good lift” in every exercise.\r\nI cleaned the data more than required just in case (even with the clean data, there is enough information).\r\nThe last thing I did was to save only important information about every competitor (row).\r\nThe meet name, for example, is irrelevant to this project.\r\nNext, I split the clean data frame into two different data frames.\r\nThe first one is the clean data that I created with the next code.\r\nThe second data frame is data that includes one competition per competitor.\r\nThis is because some competitors compete more than once and that may bias the results.\r\n\r\n\r\nShow code\r\n\r\ndat <- read.csv(\"open ipf.csv\")\r\nipf_data <- dat %>%\r\n  filter(Equipment==\"Raw\",Event==\"SBD\",Sex!=\"Mx\",WeightClassKg!=\"+\",\r\n         !is.na(Squat1Kg & Bench1Kg & Deadlift1Kg &\r\n                  Squat2Kg & Bench2Kg & Deadlift2Kg &\r\n                  Squat3Kg & Bench3Kg & Deadlift3Kg),\r\n         Best3SquatKg>0,Best3BenchKg>0,Best3DeadliftKg>0) %>%\r\n  select(-MeetName,-MeetTown,-MeetState,-MeetCountry,-Federation,-Equipment,\r\n         -Glossbrenner,-Dots)\r\nipf_data %>% writexl::write_xlsx(path = \"the final ipf cleaned data2.xlsx\")\r\n\r\n\r\nMore about the data cleaning\r\nFirst I chose only the lifters who competed in Raw and SBD events.\r\nRaw events have different characteristics than Equipped events because in Equipped events lifters can lift heavier weights, and that can affect the result of future analyses.\r\nThe SBD events contain squat, bench press, and deadlift, while other events can include only one or two lifts, this difference can affect the analyses too.\r\nThen I removed the competitors that were classified as “Mx” gender and “+-” weight class because we need defined terms for these two.\r\nThe best lift is defined as the heaviest good lift of the three attempts. In some parts of the analysis, we need lifters who have succeeded in at least one attempt of every lift. So the following step was to remove the lifters who had nonpositive numbers on the best good lifts.\r\nI could stop here with the observations cleaning but I had a lot of data so I decided to do one more thing so I can get high-quality data, so I removed the lifters who had missing value in at least one attempt.\r\nThe last thing that I did was delete unnecessary columns that don’t contribute to our data analysis.\r\nStatistical Analyses\r\nBench Press - Squat Ratio Difference Between Male and Female\r\nThe first analysis checks a familiar phenomenon:\r\nwhen males, in general, have stronger bodies than females,\r\nThe difference is not very significant in terms of the lower body, in comparison to the upper body, where there is a major dissimilarity.\r\nThe squat is an exercise that ably demonstrates lower body strength and the bench press is an exercise that effectively demonstrates upper body strength.\r\nSo, in the following analysis, I checked the ratio between the bench press of the males versus females and I compared it to the ratio of the males’ and females’ squats.\r\nI executed the next mathematical transition to make my hypothesis and conclusions more understandable:(SQ - squat)(BP - bench press)\r\n\\[\r\n\\hspace{2mm}H_O: \\dfrac{maleBP}{femaleBP}<=\\dfrac{maleSQ}{femaleSQ}\\\\\r\n\\hspace{1mm}H1: \\dfrac{maleBP}{femaleBP}\\hspace{0.5mm}>\\hspace{1mm}\\dfrac{maleSQ}{femaleSQ}\\\\\r\n\\hspace{1mm}H_O: \\dfrac{maleBP}{maleSQ}\\hspace{1mm}<=\\hspace{1mm}\\dfrac{femaleBP}{femaleSQ}\\\\\r\nH1:\\hspace{1mm}\\dfrac{maleBP}{maleSQ}\\hspace{2mm}>\\hspace{2mm}\\dfrac{femaleBP}{femaleSQ}\\\\\r\n\\]\r\n(I multiplied by \\(\\dfrac{femaleBP}{maleSQ}\\) (positive digit)).\r\nThe squat and the bench press that I used are the best attempts of the competitor.\r\nDue to the data cleaning, all the competitors on the new data have at least one good attempt.\r\nIn addition, the data frame that I used for this analysis is called, “dat”, which includes one competition per competitor.\r\n\r\n\r\nShow code\r\n\r\nrepeated_dat <- read_excel(\"the final ipf cleaned data2.xlsx\",guess_max = 20000)\r\ndat <- repeated_dat %>%\r\n  distinct(Name, .keep_all = TRUE)\r\ndat <- dat %>%  \r\n  mutate(squat_bench_ratio=Best3BenchKg/Best3SquatKg)\r\nM_sq_bp_ratio <- dat %>%\r\n  filter(Sex==\"M\") %>%\r\n  pull(squat_bench_ratio)\r\nF_sq_bp_ratio <- dat %>%\r\n  filter(Sex==\"F\") %>%\r\n  pull(squat_bench_ratio)\r\nsq_bp_test <- t.test(M_sq_bp_ratio,F_sq_bp_ratio)\r\npander(sq_bp_test,split.cells = 2)\r\n\r\nWelch Two Sample t-test: M_sq_bp_ratio and F_sq_bp_ratio\r\nTest\r\nstatistic\r\ndf\r\nP\r\nvalue\r\nAlternative\r\nhypothesis\r\nmean\r\nof\r\nx\r\nmean\r\nof\r\ny\r\n143.9\r\n71497\r\n0\r\n\r\n\r\n*\r\ntwo.sided\r\n0.68\r\n0.5717\r\n\r\nShow code\r\n\r\np1 <- ggplot(dat) +\r\n  geom_density(aes(x=squat_bench_ratio, colour=Sex, fill=Sex), alpha=0.6) +\r\n  xlim(0,1.5) +\r\n  xlab(\"squat - bench press ratio\")\r\np1 <- p1 +\r\n  scale_color_ft() +\r\n  labs(title = \"Gender SQ-BP Ratio Distribution\") +\r\n  theme_ft_rc()\r\np1\r\n\r\n\r\n\r\nThe essence of the result is as follows:The average weight of the males’ bench press is about 68% of the weight of their squat.The average weight of the Females’ bench press is about 57% of the weight of their squat.\r\nThe result is statistically highly significant and this justifies the alternative hypothesis.\r\nBench Press - Deadlift Ratio\r\nAs we saw, the ratio between two different lifts in one group can be unequal to the ratio of the same lifts in another type of group.\r\n\r\nElchonon Brody, one of the best powerlifting coaches in Israel (and thanks to him I held the Israeli record of bench press in my category) proposed the following hypothesis:\r\n\r\nThere is a difference between the ratio of two lifts in different body-weight classes.\r\n\r\n\r\nThe deadlift is a pull exercise, and the bench press is a push exercise.\r\nTherefore, there is an importance in the ratio between them for reasons of balance and body health.\r\nConsequently, I decided to check the ratio between the deadlift and bench press using the following hypothesis of Elchonon:(DL - dead lift)(HW - Heavy body weight class)(LW - Low body weight class)\r\n\\[\r\nH_O: \\dfrac{HWBP}{HWDL}<=\\dfrac{LWBP}{LWDL}\\\\\r\nH1: \\dfrac{HWBP}{HWDL}\\hspace{2.2mm}>\\hspace{2.2mm}\\dfrac{LWBP}{LWDL}\\\\\r\n\\]\r\nDifference between various competitors:\r\nElchonon believes that the ratio between bench press and deadlift is higher with heavy-weight competitors in comparison to light-weight competitors.\r\nSo, in the following analysis, I studied the hypothesis with multiple comparisons between varying weight classes.\r\nBecause we know that the ratio between different lifts can be influenced by gender, I performed the analysis only on males.\r\nIn addition, I analyzed which class has the most competitors, and then I picked the five that had the most significant difference between their weight.\r\n\r\n\r\nShow code\r\n\r\ndat <- dat %>%\r\n  mutate(deadlift_bench_ratio=Best3BenchKg/Best3DeadliftKg)\r\nWeightClass_n <- dat %>%\r\n  filter(Sex==\"M\") %>%\r\n  count(WeightClassKg) %>%\r\n  arrange(desc(n)) %>%\r\n  slice(1:10)\r\nWeightClass_n <- WeightClass_n[-7,] %>%\r\n  arrange(as.numeric(WeightClassKg)) %>%\r\n  bind_rows(WeightClass_n[7,])\r\nWeightClass_n$WeightClassKg <- reorder.factor(WeightClass_n$WeightClassKg, new.order=WeightClass_n$WeightClassKg)\r\n\r\np2 <- ggplot(WeightClass_n, aes(x=WeightClassKg,y=n)) +\r\n  geom_bar(stat=\"identity\",fill=\"steelblue\")+\r\n  geom_text(aes(label=n), vjust=-0.3, size=3.5) +\r\n  xlab(\"weight class\") + ylab(\"count\") + ylim(c(0,18000))\r\np2 <- p2 +\r\n  scale_color_ft() +\r\n  labs(title = \"Weight Class Distribution\") +\r\n  theme_ft_rc()\r\n\r\ncategories <- c(\"53\",\"66\",\"83\",\"105\",\"120+\")\r\nmultiple_comparisons_df <- dat %>%\r\n  filter(WeightClassKg %in% categories,Sex==\"M\")\r\nmultiple_comparisons_df$WeightClassKg <-\r\n  reorder.factor(multiple_comparisons_df$WeightClassKg, new.order=categories)\r\n\r\np3a <- ggplot(data=multiple_comparisons_df, aes(x=deadlift_bench_ratio, group=WeightClassKg, fill=WeightClassKg)) +\r\n    geom_density(adjust=1.5, alpha=0.65) +\r\n    xlim(0.2,1.1) + xlab(\"deadlift-bench press ratio\") +\r\n    theme_ipsum()\r\np3a <- p3a +\r\n  scale_color_ft() +\r\n  labs(title = \"Ratio Distribution\") +\r\n  theme_ft_rc()\r\n\r\np3b <- ggplot(multiple_comparisons_df, aes(x=WeightClassKg, y=deadlift_bench_ratio,color=WeightClassKg)) +\r\n  geom_boxplot() + scale_y_continuous(limits = quantile(multiple_comparisons_df$deadlift_bench_ratio, c(0.1, 0.9))) + coord_cartesian(ylim = quantile(multiple_comparisons_df$deadlift_bench_ratio, c(0.1, 0.9))) + xlab(\"weight class\") + ylab(\"bench press-deadlift ratio\")\r\n\r\np3b <- p3b +\r\n  theme_ft_rc()\r\n\r\nWeightClass_ratio <- multiple_comparisons_df %>%\r\n  group_by(WeightClassKg) %>%\r\n  summarise(ratio=mean(deadlift_bench_ratio))\r\nWeightClass_ratio$ratio <- round(WeightClass_ratio$ratio,3)\r\n\r\np4 <- ggplot(WeightClass_ratio, aes(x=WeightClassKg,y=ratio)) +\r\n  geom_bar(stat=\"identity\",fill=\"steelblue\",width = 0.55)+\r\n  geom_text(aes(label=ratio), vjust=1.6,color=\"black\", size=3.5) +\r\n  xlab(\"weight class\") + ylab(\"average deadlift-bench press ratio\")\r\n\r\np4 <- p4 +\r\n  scale_color_ft() +\r\n  labs(title = \"Weight Class Ratio difference\") +\r\n  theme_ft_rc()\r\n\r\ndl_bp_ratio <- multiple_comparisons_df$deadlift_bench_ratio\r\nwc_kg <- multiple_comparisons_df$WeightClassKg\r\ndl_bp_test <- pairwise.t.test(dl_bp_ratio,wc_kg,p.adjust.method=\"bonferroni\")\r\ndl_bp_test_df <- dl_bp_test$p.value\r\ndl_bp_test_df[which(dl_bp_test_df<2e-16)] <- \"<2e-16\"\r\n\r\n\r\nThe next bar chart shows the weight class distribution:\r\n\r\n\r\nShow code\r\n\r\np2\r\n\r\n\r\n\r\nIn the following graphs, you can see the bench press-deadlift ratio distribution in the various weight classes, and the ratio of each weight class in box plots:\r\n\r\n\r\nShow code\r\n\r\np3a\r\n\r\n\r\nShow code\r\n\r\np3b\r\n\r\n\r\n\r\nIn the following bar chart, you can see the average bench press-deadlift ratio of each weight class (from the chosen weight classes):\r\n\r\n\r\nShow code\r\n\r\np4\r\n\r\n\r\n\r\nThe following table shows the pairwise t-test:\r\n\r\n\r\nShow code\r\n\r\nkbl(dl_bp_test_df) %>%\r\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\")) %>%\r\n  add_header_above(c(\" \", \"pairwise t-test with bonferroni method\" = 4))\r\n\r\n\r\n\r\n\r\n\r\npairwise t-test with bonferroni method\r\n\r\n\r\n\r\n\r\n\r\n53\r\n\r\n\r\n66\r\n\r\n\r\n83\r\n\r\n\r\n105\r\n\r\n\r\n66\r\n\r\n\r\n<2e-16\r\n\r\n\r\nNA\r\n\r\n\r\nNA\r\n\r\n\r\nNA\r\n\r\n\r\n83\r\n\r\n\r\n<2e-16\r\n\r\n\r\n<2e-16\r\n\r\n\r\nNA\r\n\r\n\r\nNA\r\n\r\n\r\n105\r\n\r\n\r\n<2e-16\r\n\r\n\r\n<2e-16\r\n\r\n\r\n<2e-16\r\n\r\n\r\nNA\r\n\r\n\r\n120+\r\n\r\n\r\n<2e-16\r\n\r\n\r\n<2e-16\r\n\r\n\r\n<2e-16\r\n\r\n\r\n<2e-16\r\n\r\n\r\nAs you can see, on average, the bench press weight of the lightest weight class is 50.8% of the weight of their deadlift.You can see that when the weight class increases, the percentage goes up too.In addition, every pairwise comparison is statistically highly significant.\r\ndifference between the same competitors:\r\n(\\(BD_{ratio}\\) - bench press - deadlift ratio)\r\nThe next analysis is the main analysis of this project because it can give real discoveries.\r\nThe previous analysis was not enough to give suggestions, because each group has individual characteristics that can affect the result:\r\n\\[\r\nBD_{ratio}=weight_{class}+\\epsilon\r\n\\]\r\nEvery weight class has its random errors (\\(\\epsilon\\)) that may correlate with the ratio of bench press - deadlift and weight class too.\r\nHeight for example is one of them.\r\nThese correlations can affect the consistency of our estimator.\r\nThe solution that I came up with is to use the “repeated data” (the data frame which includes competitors who compete more than once).\r\nWith this data frame, I can include competitors that compete in more than one body-weight class and by that solve the consistency problem.\r\nThese competitors have several fixed characteristics that we can lose when we execute a paired ‘t test’.\r\nIn this method, we remove a part of the random errors that affected our estimation.\r\nSo the following analysis tests the difference between the bench press-deadlift ratio in two different body weight classes of the same competitor, and that can be done thanks to the “repeated data”.\r\n\r\n\r\nShow code\r\n\r\nrepeated_dat_bp_dl <- repeated_dat %>%\r\n  filter(!is.na(WeightClassKg),!is.na(BodyweightKg)) %>%\r\n  mutate(deadlift_bench_ratio=Best3BenchKg/Best3DeadliftKg)\r\n\r\nsplited_repeated <- repeated_dat_bp_dl %>%\r\n  distinct(Name,WeightClassKg,.keep_all = T) %>%\r\n  group_by(Name) %>%\r\n  filter(n()>1) %>%\r\n  summarize(Name,WeightClassKg,BodyweightKg,deadlift_bench_ratio,n=n()) %>%\r\n  ungroup() %>%\r\n  arrange(n,Name,WeightClassKg) %>%\r\n  group_split(n,.keep = T)\r\n\r\nmake_pairs <- function(data){\r\n  n <- data %>%\r\n    pull(n) %>%\r\n    unique()\r\n  pair_1 <- data[seq(1,nrow(data),by=n),]\r\n  pair_2 <- data[seq(n,nrow(data),by=n),]\r\n  return(bind_rows(pair_1,pair_2) %>% arrange(Name,BodyweightKg))\r\n}\r\n\r\npairs_list <- lapply(splited_repeated,make_pairs)\r\npairs_dat <- bind_rows(pairs_list)\r\nweights_vec <- pairs_dat %>%\r\n  pull(deadlift_bench_ratio)\r\nheavier_weight <- weights_vec[seq(2,length(weights_vec),by=2)]\r\nlower_weight <- weights_vec[seq(1,length(weights_vec),by=2)]\r\npair_test <- t.test(x = heavier_weight,y=lower_weight,paired = T)\r\npander(pair_test,split.cells = 2)\r\n\r\nPaired t-test: heavier_weight and lower_weight\r\nTest\r\nstatistic\r\ndf\r\nP\r\nvalue\r\nAlternative\r\nhypothesis\r\nmean\r\ndifference\r\n27.07\r\n20059\r\n1.63e-158\r\n\r\n\r\n*\r\ntwo.sided\r\n0.01179\r\n\r\nNow, it is easier for me to suggest some things.For example, for an individual who has shoulder pain that is caused by stronger push muscles than pull muscles, I will suggest considering this analysis.In addition, I would recommend reducing some load on this competitor’s push exercise and to lose body weight. Despite my recommendation to lose weight, I must note weight loss reduces the ratio between bench press and deadlift only by 1.1%. \r\ncode explanation\r\nFirst I removed the competitors that have missing value in bodyweight class or body weight.\r\nThe next step was to keep the competitors that compete in more than one bodyweight class, and split the competitors by the number of the different bodyweight classes that they competed in.\r\nThen, I used the make_pairs function that I created which takes only two competitions for every competitor.\r\nEventually, I used the pairs that I collected, and test the deadlift-bench press ratio of every pair with paired t-test.\r\nGood Lift and No Lift Analysis\r\nThe last statistic analysis consists of two analyses.\r\nThe first one detects if there is the same quantity of “good lift” in each exercise.\r\nThe second analysis checks if there is a correlation between one lift fail/success and another lift fail/success.\r\nIn these two analyses, I used the third attempt of every lift.\r\nIn the second analysis, I analyzed the correlation between the squat and the bench press because there are the most diverse exercises (therefore, the correlation between them is less obvious than the other combination).\r\nQuantity of “good lift” in different lifts:\r\n\r\n\r\nShow code\r\n\r\n#prop test squat3 bench3 and deadlift3 no lift\r\ndat <- dat %>%\r\n  mutate(G_squat3 = case_when(Squat3Kg>0 ~ 1,\r\n                                          TRUE ~ 0),\r\n         G_bench3 = case_when(Bench3Kg>0 ~ 1,\r\n                                          TRUE ~ 0),\r\n         G_deadlift3 = case_when(Deadlift3Kg>0 ~ 1,\r\n                                          TRUE ~ 0))\r\nG_sq <- dat %>%\r\n  filter(G_squat3==1) %>% nrow()\r\nG_bp <- dat %>%\r\n  filter(G_bench3==1) %>% nrow()\r\nG_dl <- dat %>%\r\n  filter(G_deadlift3==1) %>% nrow()\r\npop <- nrow(dat)\r\npercent <- round(c(G_sq/pop,G_bp/pop,G_dl/pop),2)\r\npercent <- percent*100\r\npercent <- as.character(percent)\r\npercent <- paste(c(\"squat:\",\"bench press:\",\"dead lift:\"),percent)\r\nwriteLines(c(\"good lift percentage:\",percent))\r\n\r\ngood lift percentage:\r\nsquat: 67\r\nbench press: 46\r\ndead lift: 65\r\n\r\nShow code\r\n\r\ngood_lifts_pt <- pairwise.prop.test(x = c(G_sq,G_bp,G_dl), n = rep(pop,3), p.adjust.method = \"bonferroni\")\r\ngood_lifts_pt_df <- good_lifts_pt$p.value\r\ngood_lifts_pt_df[which(good_lifts_pt_df<2e-16)] <- \"<2e-16\"\r\ncolnames(good_lifts_pt_df) <- c(\"squat good lifts proportion\",\"bench press good lifts proportion\")\r\nrow.names(good_lifts_pt_df) <- c(\"bench press good lifts proportion\",\"dead lift good lifts proportion\")\r\nkbl(good_lifts_pt_df) %>%\r\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\")) %>%\r\n  add_header_above(c(\" \", \"Pairwise comparison of proportions\" = 2))\r\n\r\n\r\n\r\n\r\n\r\nPairwise comparison of proportions\r\n\r\n\r\n\r\n\r\n\r\nsquat good lifts proportion\r\n\r\n\r\nbench press good lifts proportion\r\n\r\n\r\nbench press good lifts proportion\r\n\r\n\r\n<2e-16\r\n\r\n\r\nNA\r\n\r\n\r\ndead lift good lifts proportion\r\n\r\n\r\n<2e-16\r\n\r\n\r\n<2e-16\r\n\r\n\r\nThe first analysis found that on average, the percentage of the “good lift” on the third attempt is:squat - 67%, bench press - 46%, deadlift - 65%.\r\nWith the Bonferroni method, I found that the difference between every lift is statistically highly significant.\r\nThe meaning of this result is that even the 2% difference between squat and deadlift is a very rare result if the amount of “good lift” is equal between squat and deadlift.One interesting thing I found that powerlifters can use from this analysis, is the low proportion of “good lift” in the bench press.On average, there is more “no lift” than “good lift” in the third attempt, so powerlifters should take into account this result and plan the bench press attempts accordingly.\r\nCorrelation between exercises’ success/fails:\r\n\r\n\r\nShow code\r\n\r\n#chisq test no lift squat and bench\r\ngood_lifts_ct <- chisq.test(dat$G_squat3,dat$G_bench3,correct = F)\r\npander(good_lifts_ct,split.cells = 2)\r\n\r\nPearson’s Chi-squared test: dat$G_squat3 and dat$G_bench3\r\nTest\r\nstatistic\r\ndf\r\nP\r\nvalue\r\n832.2\r\n1\r\n5.368e-183\r\n\r\n\r\n*\r\n\r\nShow code\r\n\r\nobs11 <- dat %>%\r\n  filter(G_bench3==1,G_squat3==1) %>% nrow()/pop\r\nobs10 <- dat %>%\r\n  filter(G_bench3==1,G_squat3==0) %>% nrow()/pop\r\nobs01 <- dat %>%\r\n  filter(G_bench3==0,G_squat3==1) %>% nrow()/pop\r\nobs00 <- dat %>%\r\n  filter(G_bench3==0,G_squat3==0) %>% nrow()/pop\r\n\r\nexp11 <- (as.numeric(G_bp)*as.numeric(G_sq))/(pop^2)\r\nexp10 <- (G_bp*(dat %>% filter(G_squat3==0) %>% nrow))/(pop^2)\r\nexp01 <-\r\n  (as.numeric(dat %>% filter(G_bench3==0) %>% nrow)*G_sq)/(pop^2)\r\nexp00 <-\r\n  ((dat %>% filter(G_bench3==0) %>% nrow)*(dat %>% filter(G_squat3==0) %>% nrow))/(pop^2)\r\ndf <- data.frame(\r\n  group=c(\"11\",\"10\",\"01\",\"00\",\"11\",\"10\",\"01\",\"00\"),\r\n  value=c(obs11,obs10,obs01,obs00,exp11,exp10,exp01,exp00),\r\n  type=c(rep(\"observed\",4),rep(\"expected\",4))\r\n)\r\n\r\ndf$value <- round(df$value,3)\r\nnewggslopegraph(df, type, value, group,\r\n                Title = \"expected versus observed\",\r\n                SubTitle = \"\",\r\n                Caption = \"\",\r\n                YTextSize = 3,\r\n                DataTextSize = 3.5,\r\n                DataLabelPadding = 0.15,\r\n                DataLabelLineSize = 0.7,\r\n                DataLabelFillColor = \"lightblue\",\r\n                LineThickness = 1.25) + theme_minimal() +\r\n  theme(legend.position = \"none\")\r\n\r\n\r\n\r\nI will explain the second analysis via the slope graph:On the sides you can see the group splitting, the left number refers to bench press and the right number refers to squat.For example, ‘01’ (the color green) means “no lift” for bench press, and “good lift” for squat.\r\nThe left column shows the expected values of each option (the result that was expected if there is no correlation between the lifts).\r\nThe right column shows the real values that I received (the observed values).As you can see the ‘00’ and ‘11’ groups received a bigger part on the observed column, while the ‘01’ and ‘10’ got a smaller part on the observed column.So, the squat and the bench press get the same value 52% of the time (“good lift”+“no lift”).While on the expected option (the option that there is no correlation between them) they get the same value only 47% of the time.\r\nIn addition to the intuitive explanation, you can see the ‘chisq test’ before the pie chart, which detects if there is a statistically significant difference between the expected and observed values.\r\nOn the ‘chisq test’, I got a statistically significant result.\r\nNon-statistical Analyses\r\nWilks and Records Analysis\r\nIn the following analysis, you will notice some interesting facts about powerlifting competitions.\r\n\r\n\r\nShow code\r\n\r\n#age distribution\r\nAge_data_frame <- repeated_dat %>%\r\n  filter(!is.na(AgeClass)) %>%\r\n  distinct(Name,AgeClass,.keep_all = T) %>%\r\n  count(AgeClass)\r\nage_char <- Age_data_frame$AgeClass %>%\r\n  strsplit(\"-\") %>%\r\n  unlist() %>%\r\n  as.numeric() %>%\r\n  sort() %>%\r\n  as.character()\r\nage_factor <- rep(NA,length(age_char)/2)\r\nfor (i in 1:length(age_factor)){\r\n  j <- ceiling(i*2)\r\n  age_factor[i] <- paste(c(age_char[j-1]),age_char[j],sep = \"-\")\r\n}\r\nAge_data_frame$AgeClass <- reorder.factor(Age_data_frame$AgeClass, new.order=age_factor)\r\n\r\np5 <- ggplot(Age_data_frame, aes(x=AgeClass,y=n)) +\r\n  geom_bar(stat=\"identity\",fill=\"steelblue\")+\r\n  geom_text(aes(label=n), vjust=-0.3, size=3.5) +\r\n  scale_x_discrete(guide = guide_axis(angle = 90)) +\r\n  xlab(\"Age class\") + ylab(\"count\") + ylim(c(0,40000))\r\n\r\np5 <- p5 +\r\n  scale_color_ft() +\r\n  labs(title = \"Age Distribution\") +\r\n  theme_ft_rc()\r\n\r\n\r\n## records analysis\r\nrecords_dat <- repeated_dat %>%\r\n  filter(!is.na(AgeClass),!is.na(WeightClassKg),\r\n                                       !is.na(TotalKg))\r\n#oldest_record\r\noldest_record <- records_dat %>%\r\n  add_count(Sex,AgeClass,WeightClassKg) %>%\r\n  group_by(Sex,AgeClass,WeightClassKg) %>%\r\n  slice_max(TotalKg) %>%\r\n  select(Sex,AgeClass,WeightClassKg,Name,Date,TotalKg) %>%\r\n  arrange(Date)\r\n\r\n# oldest record with more than 1000 competitors\r\noldest_record1000 <- records_dat %>%\r\n  add_count(Sex,AgeClass,WeightClassKg) %>%\r\n  filter(n>1000) %>%\r\n  group_by(Sex,AgeClass,WeightClassKg) %>%\r\n  slice_max(TotalKg) %>%\r\n  select(Sex,AgeClass,WeightClassKg,Name,Date,TotalKg) %>%\r\n  arrange(Date)\r\n\r\n# the oldest competitor\r\noldest_competitor <- records_dat %>% arrange(desc(Age)) %>%\r\n  select(Name,Age,BodyweightKg,Best3SquatKg,\r\n         Best3BenchKg,Best3DeadliftKg,TotalKg) %>%\r\n  slice(1)\r\n# the heaviest total in 80 or more age group\r\nstrongest_old <- records_dat %>% filter(Age>=80) %>% slice_max(TotalKg) %>%\r\n  select(Name,Age,BodyweightKg,Best3SquatKg,\r\n         Best3BenchKg,Best3DeadliftKg,TotalKg) %>%\r\n  slice(1)\r\n\r\n\r\nFirst of all, I will present the distribution of the age class from the youngest to the oldest (the 80-999 age group means no age limit):\r\n\r\n\r\nShow code\r\n\r\np5\r\n\r\n\r\n\r\nThe first analysis shows the oldest record in IPF (the heaviest total that no one has passed throughout the years in a specific category):\r\n\r\n\r\nShow code\r\n\r\noldest_record %>%\r\n  ungroup() %>%\r\n  slice(1) %>%\r\n  gt()\r\n\r\n\r\nSex\r\n      AgeClass\r\n      WeightClassKg\r\n      Name\r\n      Date\r\n      TotalKg\r\n    M\r\n24-34\r\n110+\r\nDon Reinhoudt\r\n1973-11-09\r\n1034.18\r\n\r\nThe second analysis shows the oldest record in IPF, with more than 1,000 competitors who compete in the specific category:\r\n\r\n\r\nShow code\r\n\r\noldest_record1000 %>%\r\n  ungroup() %>%\r\n  slice(1) %>%\r\n  gt()\r\n\r\n\r\nSex\r\n      AgeClass\r\n      WeightClassKg\r\n      Name\r\n      Date\r\n      TotalKg\r\n    M\r\n16-17\r\n66\r\nYosuke Kiuchi\r\n2014-03-23\r\n620\r\n\r\nThe third analysis shows the oldest competitor that ever competed on the IPF:\r\n\r\n\r\nShow code\r\n\r\ngt(oldest_competitor)\r\n\r\n\r\nName\r\n      Age\r\n      BodyweightKg\r\n      Best3SquatKg\r\n      Best3BenchKg\r\n      Best3DeadliftKg\r\n      TotalKg\r\n    Svend Stensgaard\r\n92.5\r\n78.2\r\n65\r\n60\r\n125\r\n250\r\n\r\nThe fourth analysis shows the heaviest total that a competitor 80 years old or more lifted in a competition:\r\n\r\n\r\nShow code\r\n\r\ngt(strongest_old)\r\n\r\n\r\nName\r\n      Age\r\n      BodyweightKg\r\n      Best3SquatKg\r\n      Best3BenchKg\r\n      Best3DeadliftKg\r\n      TotalKg\r\n    Emil Alin\r\n81.5\r\n112.7\r\n155\r\n110\r\n200\r\n465\r\n\r\nDifferences Between Countries\r\nTo understand this analysis, you must learn an additional term in power lifters’ vocabulary, ‘Wilks’.\r\nThe ‘Wilks’ is a formula that is used to compare lifters in different body weight classes in order to find the strongest lifter while taking into account the lifter’s body weight.\r\n\r\n\r\nShow code\r\n\r\ncountries_competitors <- dat %>%\r\n  filter(!is.na(Country)) %>%\r\n  count(Country) %>%\r\n  arrange(desc(n)) %>%\r\n  head(10)\r\n\r\np6 <- ggplot(data=countries_competitors, aes(x=reorder(Country,desc(n)),y=n)) + geom_bar(stat=\"identity\", fill=\"steelblue\")+\r\n  geom_text(aes(label=n), vjust=-0.3, size=3.5) +\r\n  scale_x_discrete(guide = guide_axis(angle = 90)) +\r\n  ylim(c(0,50000))  + xlab(\"country\") + ylab(\"count\")\r\n\r\np6 <- p6 +\r\n  scale_color_ft() +\r\n  labs(title = \"Competitors Per Country\") +\r\n  theme_ft_rc()\r\n\r\nstrongest_five <- dat %>%\r\n  arrange(desc(Wilks)) %>%\r\n  slice(1:5) %>%\r\n  select(Country,Wilks)\r\n\r\n#most and least percentages of female competitors\r\ndat_fem <- dat %>%\r\n  add_count(Country) %>%\r\n  filter(n>200)\r\ndat_fem <- dat_fem %>%\r\n  group_by(Country) %>%\r\n  summarise(female_precentage=mean(Sex==\"F\"))\r\nmin_max <- dat_fem %>%\r\n  filter(female_precentage%in%\r\n                     c(min(dat_fem$female_precentage),\r\n                       max(dat_fem$female_precentage)))\r\nmin_max$female_precentage <- round(min_max$female_precentage,2)\r\n\r\n\r\np7 <- ggplot(data=min_max, aes(x=Country, y=female_precentage)) + geom_bar(stat=\"identity\",fill=\"steelblue\",width = 0.3) +\r\n  geom_text(aes(label=female_precentage), vjust=1.6,\r\n            color=\"black\", size=3.5)  + xlab(\"country\") + ylab(\"proportion\")\r\np7 <- p7 +\r\n  scale_color_ft() +\r\n  labs(title = \"Female Percentage\") +\r\n  theme_ft_rc()\r\n\r\n\r\nFirst of all, I presented the countries that had the most amount of lifters:\r\n\r\n\r\nShow code\r\n\r\np6\r\n\r\n\r\n\r\nThe first analysis takes the lifters that get the highest Wilks score, and checks from which countries they originated from:\r\n\r\n\r\nShow code\r\n\r\ngt(strongest_five)\r\n\r\n\r\nCountry\r\n      Wilks\r\n    USA\r\n600.98USA\r\n581.16Russia\r\n578.52Poland\r\n569.83USA\r\n567.83\r\n\r\nAs you can see, the strongest competitors in the IPF are from the USA, Russia, and Poland.\r\nIf the strength of the lifter is independent of his/her country, Russia and Poland are surprising results because there are some countries with more competitors than this two.\r\n/\r\n/\r\nThe second analysis shows the countries with the most and the least percentages of female competitors (when taking only into consideration countries with more than 200 competitors).\r\n\r\n\r\nShow code\r\n\r\np7\r\n\r\n\r\n\r\nThis result is very interesting because the difference is quite big.\r\nSo I decided to check some factors that can relate to the outcome.\r\nI by checking the female percentage in Sweden and Belgium over the years and I was even more surprised.Female percentage in Sweden and Belgium\r\nIn this link you can see that Belgium’s female percentage was higher than Sweden’s female percentage from 1960 to 2021.\r\nHowever, Sweden has a higher score on ‘Gender Equality Index’ in every year that exists in the following link:Gender Equality Index\r\nThose who are interested in this difference can request from me more analyses on the females’ percentage in IPF.\r\nThese two factors I mentioned do not suffice. Another analysis can detect countries with a lower female percentage and a lower score on the ‘Gender Equality Index’ in comparison to Belgium. Nevertheless, Belgium is the country with the lowest female percentage in IPF.\r\nTherefore, additional factors influence the observed result.\r\nCompeted the Most Amount of Times\r\nIn this final analysis, I found the competitor that competed the most amount of times in the IPF (remember, this data includes only SBD and RAW events).\r\n\r\n\r\nShow code\r\n\r\nrepeated_dat %>%\r\n  count(Name) %>%\r\n  arrange(desc(n)) %>%\r\n  slice(1) %>%\r\n  pander()\r\n\r\nName\r\nn\r\nCharlie Chester\r\n46\r\n\r\nShow code\r\n\r\nCharlie_progress <- repeated_dat %>%\r\n  filter(Name==\"Charlie Chester\") %>%\r\n  arrange(Date) %>%\r\n  select(Date,Best3SquatKg,Best3BenchKg,Best3DeadliftKg,TotalKg)\r\nCharlie_progress <- mutate(Charlie_progress, Date= as.Date(Date))\r\nCharlie_plot <- ggplot(Charlie_progress, aes(x=Date)) +\r\n  geom_line(aes(y = Best3SquatKg), color = \"blue\") +\r\n  geom_line(aes(y = Best3BenchKg), color=\"black\") +\r\n  geom_line(aes(y = Best3DeadliftKg), color=\"red\") +\r\n  transition_reveal(Date) +\r\n  labs(title = 'Competition : {frame_time}')\r\nanimate(\r\n  plot = Charlie_plot,\r\n  render = gifski_renderer())\r\n\r\n\r\n\r\nIn the graph, you can see Charlie’s bench press (in black), squat (in blue), and deadlift (in red).What you may find interesting is how the trends in the lifts are very similar.\r\nThe similar trends can match the ‘chisq test’ in this project, which ultimately found a correlation between squat and bench press success and failure.\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-10-08-powerlifting-analysis-using-r/powerlifting-analysis-using-r_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-11-10T21:10:26+02:00",
    "input_file": "powerlifting-analysis-using-r.knit.md"
  }
]
